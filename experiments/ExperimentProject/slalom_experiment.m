for p = 2:3
    disp("Slalom Experiment with p = " + int2str(p));
    disp("============================");
    disp("");

    params = struct( ...
                    p = p, ...
                    problem = '{"name": "slalom", "x0": [0.5, 0]}', ...
                    x0_type = "default", ...
                    update_sigma0 = 50, ...
                    update_type = "Simple", ...
                    update_use_prerejection = false, ...
                    update_sigma_decrease = 1, ...
                    stop_rule = "Function_Value", ...
                    stop_f_threshold = -3.45, ...
                    inner_solver = "fminunc_trust-region", ...
                    inner_x0_shift = [-0.1; 0], ...
                    inner_stop_rule = "First_Order", ...
                    inner_stop_tolerance_g = 1e-9, ...
                    inner_stop_max_iterations = 1000 ...
                   );

    if p == 2
        params.inner_solver = "MCMR";
        params = rmfield(params, "inner_x0_shift");
    else % p == 3
        params.inner_solver = "AR2";
        params.inner_x0_shift = [-0.1; 0];
        params.inner_inner_solver = "MCMR";
        params.inner_inner_stop_rule = "First_Order";
        params.inner_inner_stop_tolerance_g = 1e-10;
    end

    history = training(params);

    disp(struct2table(history(end)));
end

for p = 2:3
    disp("Hairpin Turn Experiment with p = " + int2str(p));
    disp("==================================");
    disp("");

    params = struct( ...
                    p = p, ...
                    problem = '{"name": "hairpin_turn", "x0": [0.5, 0]}', ...
                    x0_type = "default", ...
                    update_sigma0 = 50, ...
                    update_type = "Simple", ...
                    update_use_prerejection = false, ...
                    update_sigma_decrease = 1, ...
                    stop_rule = "First_Order", ...
                    stop_tolerance_g = 1e-7, ...
                    inner_solver = "fminunc_trust-region", ...
                    inner_x0_shift = [-0.1; 0], ...
                    inner_stop_rule = "First_Order", ...
                    inner_stop_tolerance_g = 1e-9, ...
                    inner_stop_max_iterations = 1000 ...
                   );

    if p == 2
        params.inner_solver = "MCMR";
        params = rmfield(params, "inner_x0_shift");
    else % p == 3
        params.inner_solver = "AR2";
        params.inner_x0_shift = [-0.1; 0];
        params.inner_inner_solver = "MCMR";
        params.inner_inner_stop_rule = "First_Order";
        params.inner_inner_stop_tolerance_g = 1e-10;
    end

    history = training(params);

    disp(struct2table(history(end)));
end
